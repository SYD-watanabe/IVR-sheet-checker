# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [1.1.0] - 2026-01-16

### Added
- 🎯 **修正済み文章の自動生成機能** - AIの指摘を元に、元の文章から誤字を修正した完全な文章を自動生成
- 📋 **ワンクリックコピー機能** - 修正済み文章をクリップボードに即座にコピー（コピー完了のビジュアルフィードバック付き）
- 📊 **バッチ番号の進捗表示** - 現在のバッチ番号と総バッチ数を表示（例: バッチ 3/10）
- ⏱️ **バッチ間の待機時間** - レート制限対策として各バッチ間に3秒の待機時間を追加

### Changed
- ⚡ **バッチサイズの増量** - 5個/バッチ → 10個/バッチに変更（RPMをさらに50%削減）
- 💡 **エラーメッセージの改善** - より詳細な情報（現在の制限値、待機時間、推定処理時間）を表示
- 🎨 **UI/UXの改善** - 元の文章と修正後の文章を明確に分離して表示

### Fixed
- 🐛 **レート制限エラーの頻発** - バッチサイズ増量と待機時間追加により、200個のオブジェクトまで確実に処理可能に
- 🔧 **20 RPM制限への対応** - Gemini 2.5 Flash Liteの実際の制限（20 RPM）に最適化

### Technical
- 新規関数: `copyToClipboard()` - クリップボードAPI使用
- 新規関数: `escapeRegExp()` - 正規表現の特殊文字エスケープ
- 改善: `displayErrorResults()` - 修正済み文章生成ロジックを追加
- 改善: `checkTextWithGemini()` - バッチ間待機処理を追加
- 改善: エラーハンドリング - より詳細な情報抽出と表示

### Performance
- **RPM削減**: 従来比 90%削減（100個 → 10リクエスト）
- **処理時間**: 100個のオブジェクトを約80秒で処理（従来: 180秒以上）
- **作業効率**: 手動修正作業が不要になり、約10倍の効率化

---

## [1.0.0] - 2026-01-15

### Added
- 🎉 **初回リリース**
- 📤 **Excelファイルアップロード機能** - ドラッグ&ドロップ対応
- 🔍 **オブジェクトテキスト抽出** - 図形・テキストボックスからテキストを自動抽出
- 🤖 **AI誤字脱字チェック** - Gemini 2.5 Flash Lite使用
- 📦 **バッチ処理** - 5個ずつまとめて処理（RPM削減）
- 🚫 **スマートフィルタリング** - 特定シート・テキストパターンの除外
- 🔄 **自動リトライ機能** - レート制限時の自動待機・リトライ
- 📁 **コンパクト表示** - 抽出結果の折りたたみ表示
- 💾 **APIキー管理** - ローカルストレージに安全保存

### Features
- SheetJS使用のExcel解析
- JSZip使用の内部XML解析
- Drawing XMLとVML形式の両対応
- 詳細な指摘表示（誤り・修正案・理由）
- レスポンシブデザイン（Tailwind CSS）

### Supported Formats
- .xlsx (Office Open XML)
- .xlsm (マクロ有効ワークブック)
- 図形（Shape）
- テキストボックス
- VMLオブジェクト

---

## [Unreleased]

### Planned Features
- 📥 修正版Excelファイルの自動生成・ダウンロード
- 🔢 複数ファイルの一括処理（バッチアップロード）
- 📚 カスタム辞書登録機能
- 📊 チェック履歴の保存・参照
- 📄 レポートのPDF/CSV出力
- ⚙️ バッチサイズの動的調整

---

## Version History

- **v1.1.0** (2026-01-16) - バッチ処理改善 + 修正済み文章コピー機能
- **v1.0.0** (2026-01-15) - 初回リリース

---

## Migration Guide

### v1.0.0 → v1.1.0

**変更なし**: 既存の使い方で自動的に新機能が利用可能です。

**新機能の使い方**:
1. チェック結果の「✅ 修正後の文章」を確認
2. 「📋 コピー」ボタンをクリック
3. Excelのオブジェクトに貼り付け（Ctrl+V / Cmd+V）

**APIキー**: 既存のAPIキーがそのまま使用可能です。

**注意事項**: 
- バッチサイズ変更により、処理時間が若干長くなる場合があります（待機時間3秒/バッチ）
- ただし、レート制限エラーが大幅に減少し、全体的な成功率が向上します

---

## Support

問題が発生した場合は、[Issues](https://github.com/YOUR_USERNAME/IVR-sheet-checker/issues)を開いてください。
